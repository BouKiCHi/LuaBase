-- test_gui.lexe

local mod = do_module("mod_base.lmod")

-- ui helper 

local helper = do_submod("gui_helper.lsub")

-- routines


function mod.init()

	mod.y = 16
	mod.h = mod.sh - 16
	
	mod.win  = gui.createWindow( mod.x , mod.y , mod.w , mod.h )
	mod.box  = gui.createBox( 0 , 0 , mod.w , mod.h )
		
	
	local x = mod.w * 0.1
	local y = mod.h * 0.1

	mod.text = gui.createText ( x , y , "PLEASE ENTER YOUR NAME" )
	
	y = y + 25
	
	mod.textedit = gui.createTextEdit ( x , y , mod.w - (x*2) , 20 , "None" )

	x = mod.w * 0.8
	y = mod.h * 0.8

	mod.button = gui.createButton ( x , y , 30 , 20 , "OK" )

	gui.appendChild ( mod.box , mod.text )
	gui.appendChild ( mod.box , mod.textedit )
	gui.appendChild ( mod.box , mod.button )
	gui.append ( mod.win , mod.box )

    
    helper.initWithMod( mod )

    local row = helper.newRow()
    helper.addObject( row , mod.textedit , helper.actInput )
    helper.addObject( row , mod.button , mod.actDialog )
    helper.addRow ( row )
    
    helper.start()
    
	
	mod.keyboard = do_module("keyboard.lmod")
end

function mod.actDialogNotify()
    if helper.dialog.isDone()
    then
        helper.restoreCallback()

        if helper.dialog.getResult() == 1 then
            mod.doFinish()
        end

        helper.dialog.reset()
        gui.setUpdate ( mod.win )
    end
end


function mod.actDialog()
    helper.dialog = do_module ( "diag.lmod" )

    helper.dialog.start()
    helper.dialog.setMessage("QUIT THIS PROGRAM?")
    helper.dialog.setButtons({"YES","NO"})

    helper.setCallback ( mod.actDialogNotify )
end

function mod.checkNotify()
end

function mod.moveFocus()
	local obj = mod.focusList [ mod.focusPos ]
	
	gui.setFocus ( mod.win , obj )
	gui.setUpdate ( mod.win )
end

function mod.checkKey()
    helper.checkKey()

	if key.Select()
	then
		mod.doFinish()
	end
end

return mod